<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>北海道地名タイピング</title>
    <link rel="stylesheet" href="/style.css">
    <link rel="stylesheet" href="/typing-style.css">
</head>
<body>
    <div id="start-screen" class="container">
        <h1>地名タイピング</h1>
        <p>制限時間を選択して、タイピングの腕を試そう！</p>
        <div class="time-options">
            <button class="time-btn" data-time="60">60秒チャレンジ (ローマ字)</button>
            <button class="time-btn" data-time="120">120秒チャレンジ (ローマ字)</button>
            <button class="time-btn" data-time="180">180秒チャレンジ (ローマ字)</button>
            <button id="flick-mode-btn" class="time-btn" style="background: linear-gradient(145deg, #e67e22, #d35400);">60秒チャレンジ (フリック)</button>
        </div>
        <a href="/" class="secondary-btn" style="margin-top: 2rem;">トップページに戻る</a>
    </div>

    <div id="game-screen" class="container typing-mode" style="display: none;">
        <div id="stats-bar">
            <div id="timer" class="stat-item">時間: <span>--</span></div>
            <div id="kpm" class="stat-item">KPM: <span>0</span></div>
            <div id="accuracy" class="stat-item">正確率: <span>100%</span></div>
        </div>
        
        <div id="game-area-wrapper">
            <div id="word-container">
                <div id="kanji-display"></div>
                <div id="hiragana-display"></div>
                <div id="romaji-display"></div>
            </div>
            <div id="combo-display" class="combo-animation"></div>
            <div id="score-display">SCORE: 0</div>
            
            <p class="mobile-hint">画面をタップしてキーボードを表示</p>
        </div>

        <input type="text" id="mobile-input-trap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" inputmode="url">
    </div>

    <div id="results-screen" class="container" style="display: none;">
        <h1>結果</h1>
        <div class="result-grid">
            <div class="result-item">
                <span class="result-label">最終スコア</span>
                <span id="final-score" class="result-value">0</span>
            </div>
            <div class="result-item">
                <span class="result-label">最高コンボ</span>
                <span id="max-combo" class="result-value">0</span>
            </div>
            <div class="result-item">
                <span class="result-label">平均KPM</span>
                <span id="avg-kpm" class="result-value">0</span>
            </div>
            <div class="result-item">
                <span class="result-label">正確率</span>
                <span id="final-accuracy" class="result-value">0%</span>
            </div>
        </div>
        
        <div id="highscore-message"></div>
        <div id="xp-message"></div>

        <div id="guest-score-form" style="display: none; margin-top: 1.5rem; border-top: 1px solid #eee; padding-top: 1rem;">
            <h3>ランキングに登録しますか？</h3>
            <input type="text" id="guest-name" placeholder="名前を入力 (10文字以内)" maxlength="10" class="auth-input" style="width: 80%; margin: 0 auto 1rem auto;">
            <button id="submit-guest-score-btn" class="auth-button" style="background-color: #f39c12;">ランキングに登録</button>
            <button id="skip-guest-score-btn" class="secondary-btn" style="margin-top: 0.5rem; background-color: #95a5a6;">登録しない</button>
        </div>
        <div class="result-actions" id="logged-in-actions">
            <button id="play-again-btn">もう一度プレイ</button>
            <a href="/" class="secondary-btn">トップページに戻る</a>
        </div>
    </div>

    <script src="/socket.io/socket.io.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
    <script src="/firebase-config.js"></script>
    <script src="/typing.js"></script>
</body>
</html>