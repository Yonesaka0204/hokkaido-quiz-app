<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>クイズ挑戦中！ - 北海道地名漢字クイズ</title>
    <link rel="stylesheet" href="/style.css">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>❄️</text></svg>">
</head>
<body>
    <!-- プレイヤーステータス表示 -->
    <div id="player-status-container" style="display: none;">
        <h3>👥 参加者ステータス</h3>
        <ul id="player-status-list"></ul>
    </div>

    <div class="container">
        <!-- ヘッダー部分 -->
        <div class="main-header" style="display: flex; justify-content: space-between; align-items: center; width: 100%; margin-bottom: 2rem; background: rgba(255, 255, 255, 0.8); backdrop-filter: blur(10px); padding: 1rem; border-radius: 12px; border: 1px solid var(--hokkaido-border);">
            <div style="display: flex; align-items: center; gap: 1rem;">
                <p id="progress" style="font-size: 1.1rem; font-weight: 600; margin: 0; color: var(--hokkaido-blue);"></p>
                <div id="timer" style="font-size: 1rem; color: var(--hokkaido-text-light);"></div>
            </div>
            <button id="chat-toggle-btn" style="width: 45px; height: 45px; border-radius: 50%; background: var(--gradient-primary); color: white; border: none; box-shadow: 0 4px 12px var(--hokkaido-shadow); cursor: pointer; display: flex; justify-content: center; align-items: center; transition: all 0.3s ease;">
                💬
            </button>
        </div>
        
        <!-- 問題表示エリア -->
        <div style="background: rgba(255, 255, 255, 0.9); backdrop-filter: blur(10px); padding: 2rem; border-radius: 20px; border: 1px solid var(--hokkaido-border); box-shadow: 0 8px 32px var(--hokkaido-shadow); margin-bottom: 2rem;">
            <h2 id="question" style="color: var(--hokkaido-blue); font-size: 1.8rem; font-weight: 700; margin: 0 0 1rem 0; line-height: 1.4;">
                クイズの開始を待っています... ⏳
            </h2>
            <p style="color: var(--hokkaido-text-light); margin: 0; font-size: 1rem;">
                他のプレイヤーの参加をお待ちください
            </p>
        </div>

        <!-- 選択肢コンテナ -->
        <div id="options-container" style="margin-bottom: 2rem;"></div>

        <!-- 結果表示エリア -->
        <div id="result" style="min-height: 80px; display: flex; align-items: center; justify-content: center; font-size: 2rem; font-weight: 700; border-radius: 16px; padding: 1rem; transition: all 0.3s ease;"></div>

        <!-- 入力フィールド（記述式の場合） -->
        <div id="input-container" style="display: none; margin-bottom: 2rem;">
            <input id="answer-input" type="text" placeholder="地名を入力してください..." class="auth-input" style="font-size: 1.2rem; text-align: center;">
            <button id="submit-answer-btn" class="auth-button" style="background: var(--gradient-primary); margin-top: 1rem;">
                🎯 回答を送信
            </button>
        </div>

        <!-- 次の問題へのボタン -->
        <button id="next-question-btn" class="auth-button" style="background: var(--gradient-secondary); display: none;">
            ➡️ 次の問題へ
        </button>
    </div>

    <!-- ロビーに戻るボタン -->
    <button id="back-to-lobby-btn" class="secondary-btn" style="position: fixed; bottom: 20px; left: 20px; background: var(--hokkaido-text-light); color: white; border: none; padding: 0.75rem 1.5rem; border-radius: 25px; cursor: pointer; box-shadow: 0 4px 12px var(--hokkaido-shadow); transition: all 0.3s ease;">
        🏠 ロビーに戻る
    </button>

    <!-- チャットパネル -->
    <div id="chat-panel" style="position: fixed; top: 0; right: 0; width: 300px; height: 100%; background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(15px); box-shadow: -8px 0 32px var(--hokkaido-shadow); z-index: 999; transform: translateX(100%); transition: transform 0.3s ease-in-out; display: flex; flex-direction: column; padding: 1rem; box-sizing: border-box; border-left: 1px solid var(--hokkaido-border);">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; padding-bottom: 1rem; border-bottom: 1px solid var(--hokkaido-border);">
            <h3 style="margin: 0; color: var(--hokkaido-blue);">💬 チャット</h3>
            <button id="close-chat-btn" style="background: none; border: none; font-size: 1.5rem; cursor: pointer; color: var(--hokkaido-text-light); padding: 0;">×</button>
        </div>
        <div id="chat-messages" style="flex-grow: 1; overflow-y: auto; padding: 0.5rem; background: rgba(248, 250, 252, 0.5); border-radius: 8px; margin-bottom: 1rem; min-height: 200px;"></div>
        <form id="chat-form" style="display: flex; gap: 0.5rem;">
            <input id="chat-input" type="text" autocomplete="off" placeholder="メッセージを入力..." style="flex-grow: 1; padding: 0.75rem; border: 1px solid var(--hokkaido-border); border-radius: 8px; font-size: 0.9rem;">
            <button type="submit" style="background: var(--gradient-primary); color: white; border: none; padding: 0.75rem 1rem; border-radius: 8px; cursor: pointer; font-size: 0.9rem;">送信</button>
        </form>
    </div>

    <!-- ローディングオーバーレイ -->
    <div id="loading-overlay" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(255, 255, 255, 0.9); backdrop-filter: blur(5px); display: none; justify-content: center; align-items: center; z-index: 1000;">
        <div style="text-align: center;">
            <div class="loading" style="width: 40px; height: 40px; border: 4px solid var(--hokkaido-border); border-radius: 50%; border-top-color: var(--hokkaido-light-blue); animation: spin 1s ease-in-out infinite; margin: 0 auto 1rem;"></div>
            <p style="color: var(--hokkaido-text); font-size: 1.1rem; margin: 0;">読み込み中...</p>
        </div>
    </div>

    <!-- 通知エリア -->
    <div id="notification-area" style="position: fixed; top: 20px; right: 20px; z-index: 1001; max-width: 300px;"></div>

    <script src="/socket.io/socket.io.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
  
    <script src="/firebase-config.js"></script>
    <script src="/quiz.js"></script>
</body>
</html>